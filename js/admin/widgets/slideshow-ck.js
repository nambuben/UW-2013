jQuery(document).ready(function(e){var t,n="slideshow-images",r="slideshow";e("body").on("click",".select-a-gallery",function(r){r.preventDefault();var i=e(this),s=i.siblings(".slideshow-preview"),o=i.siblings("input");t||(t=wp.media.frames.frame=wp.media({className:"media-frame uw-gallery-media-frame",frame:"post",state:s.children().length>0?"gallery-edit":"gallery",multiple:!0,title:"Select an image"}));t.on("update",function(){var r=t.state().get("library").toJSON(),s=i.siblings(".slideshow-preview"),u=wp.media.template(n),a=urls=[];s.empty();e.each(r,function(e,t){s.append(u(t));a.push(t.id)});o.first().val(a)});t.on("activate",function(){var n=t.state().get("library"),r=o.first().val(),i=r?r.split(","):!1;i&&e.each(i,function(e,t){n.add(wp.media.attachment(t))})});t.open()});var i=function(){e(".slideshow-preview").each(function(){var t=e(this),r=wp.media.template(n),i=t.siblings("input").first().val();if(!i)return;e.each(i.split(","),function(n,i){var s=e("<div />").attr("id",i);t.append(s);wp.media.attachment(i).fetch().done(function(e){t.find("div#"+i).append(r(e)).find("li").unwrap()})})})};e(this).ajaxSuccess(function(e,t,n){n.data.indexOf("action=save-widget")!=-1&&n.data.indexOf("id_base="+r)!=-1&&i()});i()});